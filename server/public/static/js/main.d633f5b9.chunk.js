(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{102:function(e,t,a){},103:function(e,t,a){},104:function(e,t,a){},105:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(32),l=a.n(o),s=a(7),c=a(11),i=a(13),u=a(12),m=a(33),p=(a(77),a(78),a(37)),h=a(36),d=a(44),g=a.n(d),E=function e(){var t=this;Object(s.a)(this,e),this.signup=function(e){var a=e.username,n=e.password;return t.service.post("/signup",{username:a,password:n})},this.login=function(e){var a=e.username,n=e.password;return t.service.post("/login",{username:a,password:n})},this.logout=function(){return t.service.post("/logout")},this.isLoggedIn=function(){return t.service.get("/loggedin")},this.service=g.a.create({baseURL:"".concat("https://revitalize.herokuapp.com","/api"),withCredentials:!0})},f=a(8),j=function(e){Object(i.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).logout=function(){n.props.setTheUser(!1),n.authService.logout()},n.authService=new E,n}return Object(c.a)(a,[{key:"render",value:function(){return r.a.createElement(p.a,{expand:"md"},r.a.createElement(p.a.Brand,{as:"div"},r.a.createElement(f.b,{to:"/"},"Revitalize the planet!")),r.a.createElement(p.a.Toggle,{"aria-controls":"basic-navbar-nav"}),r.a.createElement(p.a.Collapse,{id:"basic-navbar-nav"},r.a.createElement(h.a,null,r.a.createElement(h.a.Link,{as:"div"},r.a.createElement(f.b,{to:"/"},"Home")),r.a.createElement(h.a.Link,{as:"div"},r.a.createElement(f.b,{to:"/projects"},"Discover projects")),this.props.loggedInUser?r.a.createElement(r.a.Fragment,null,r.a.createElement(h.a.Link,{as:"div"},r.a.createElement(f.b,{to:"/profile"},"My profile")),r.a.createElement(h.a.Link,{as:"div",onClick:this.logout},"Close session")):r.a.createElement(r.a.Fragment,null,r.a.createElement(h.a.Link,{as:"div"},r.a.createElement(f.b,{to:"/login"},"Login")),r.a.createElement(h.a.Link,{as:"div"},r.a.createElement(f.b,{to:"/signup"},"Sign up")))),r.a.createElement(p.a.Text,{className:"ml-auto"}," Hello, ",this.props.loggedInUser?this.props.loggedInUser.username:"invitad@"),r.a.createElement(p.a.Text,null,this.props.loggedInUser?"Wallet"+this.props.loggedInUser.wallet+"\u20ac":"0")))}}]),a}(n.Component),b=a(21),v=function e(){var t=this;Object(s.a)(this,e),this.getAllProjects=function(){return t.service.get("/getAllProjects")},this.getProject=function(e){return t.service.get("/getOneProject/".concat(e))},this.createProject=function(e){return t.service.post("/postProject",e)},this.updateProject=function(e){return t.service.post("/updateProject/",e)},this.service=g.a.create({baseURL:"".concat("https://revitalize.herokuapp.com","/api"),withCredentials:!0})},I=(a(102),a(14)),w=a(30),O=function(e){return r.a.createElement(I.a,{lg:3,md:6},r.a.createElement(w.a,{as:"article"},r.a.createElement(w.a.Img,{variant:"top",src:e.photos[0]}),r.a.createElement(w.a.Body,null,r.a.createElement(w.a.Title,null,e.description),r.a.createElement("small",null,"#",e.projectType),r.a.createElement("p",null,e.city),r.a.createElement(f.b,{to:"/projects/".concat(e._id),className:"btn btn-dark btn-block btn-sm"},"see more details"))))},S=a(26),y=a(16),C=a(6),U=a(17),P=function(e){Object(i.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).handleInputChange=function(e){var t=e.target,a=t.name,r=t.value;n.setState(Object(S.a)({},a,r))},n.handleSubmit=function(e){e.preventDefault(),n.projectService.createProject(n.state).then((function(){return n.props.finishProjectPost()})).catch((function(e){return console.log(e)}))},n.state={description:"",goal:0},n.projectService=new v,n}return Object(c.a)(a,[{key:"render",value:function(){var e=this;return r.a.createElement(y.a,null,r.a.createElement("h1",null,"Create new project"),r.a.createElement("hr",null),r.a.createElement(C.a,{onSubmit:this.handleSubmit},r.a.createElement(C.a.Group,{controlId:"desc"},r.a.createElement(C.a.Label,null,"Description"),r.a.createElement(C.a.Control,{name:"description",type:"text",value:this.state.description,onChange:this.handleInputChange})),r.a.createElement(C.a.Group,{controlId:"inv"},r.a.createElement(C.a.Label,null,"Goal"),r.a.createElement(C.a.Control,{name:"inversions",type:"text",value:this.state.inversions,onChange:this.handleInputChange})),r.a.createElement(U.a,{type:"submit"},"Create"),r.a.createElement(U.a,{onClick:function(){return e.props.closeModal()},style:{marginRight:"10px"}},"Close")))}}]),a}(n.Component),k=a(15),x=a(35),M=a(39),N=function(e){Object(i.a)(a,e);var t=Object(u.a)(a);function a(){var e;return Object(s.a)(this,a),(e=t.call(this)).handleModal=function(t){return e.setState({modalShow:t})},e.handletoast=function(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=Object(b.a)({},e.state.toast);n.show=t,n.text=a,e.setState({toast:n})},e.getAllProjects=function(){e.projectService.getAllProjects().then((function(t){return e.setState({projects:t.data})})).catch((function(e){return console.log(e)}))},e.componentDidMount=function(){e.getAllProjects()},e.finishProjectPost=function(){e.getAllProjects(),e.handleModal(!1),e.handletoast(!0,"Saved in the Data Base")},e.state={modalShow:!1,toast:{show:!1,text:""},projects:[]},e.projectService=new v,e}return Object(c.a)(a,[{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement(y.a,{as:"section"},r.a.createElement("h1",null,"Projects List"),this.props.loggedInUser&&r.a.createElement(U.a,{onClick:function(){return e.handleModal(!0)},variant:"dark",style:{marginBottom:"20px"}},"Create new project"),this.state.projects?r.a.createElement(k.a,{className:"projects-list"},this.state.projects.map((function(e){return r.a.createElement(O,Object.assign({key:e._id},e))}))):r.a.createElement("h1",null,"Loading..."),r.a.createElement(M.a,{className:"create-modal",show:this.state.modalShow,onHide:function(){return e.handleModal(!1)}},r.a.createElement(M.a.Body,null,r.a.createElement(P,{finishProjectPost:this.finishProjectPost,closeModal:function(){return e.handleModal(!1)}}))),r.a.createElement(x.a,{onClose:function(){return e.handletoast(!1)},show:this.state.toast.show,delay:3e3,autohide:!0},r.a.createElement(x.a.Header,null,r.a.createElement("img",{src:"holder.js/20x20?text=%20",className:"rounded mr-2",alt:""}),r.a.createElement("strong",{className:"mr-auto"},"Message")),r.a.createElement(x.a.Body,null,this.state.toast.text))))}}]),a}(n.Component),L=function(e){Object(i.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).handleInputChange=function(e){var t=e.target,a=t.name,r=t.value;n.setState(Object(S.a)({},a,r))},n.handleSubmit=function(e){e.preventDefault();var t=n.state.amount,a={modifiedAmount:n.props.project.currentAmount+=Number(t),modifiedWallet:n.props.creator.wallet-=Number(t),modifiedMoneySpent:n.props.creator.moneySpent+=Number(t),project:n.props.project._id,creator:n.props.creator._id};console.log("En el submit ---\x3e"),console.log(a),n.projectService.updateProject(a).then((function(){return n.props.finishProjectPost()})).catch((function(e){return console.log(e)}))},n.state={amount:1},n.projectService=new v,n}return Object(c.a)(a,[{key:"render",value:function(){var e=this;return r.a.createElement(y.a,null,r.a.createElement(C.a,{onSubmit:this.handleSubmit},r.a.createElement(C.a.Group,{controlId:"contribution"},r.a.createElement(C.a.Label,null,"Your contribution"),r.a.createElement(C.a.Control,{name:"amount",type:"text",value:this.state.amount,onChange:this.handleInputChange})),r.a.createElement(U.a,{type:"submit"},"Complete"),r.a.createElement(U.a,{onClick:function(){return e.props.closeModal()},style:{marginRight:"10px"}},"Close")))}}]),a}(n.Component),T=(a(103),function(e){Object(i.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).handleModal=function(e){return n.setState({modalShow:e})},n.handletoast=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=Object(b.a)({},n.state.toast);a.show=e,a.text=t,n.setState({toast:a})},n.finishProjectPost=function(){n.getProjectInfo(),n.handleModal(!1),n.handletoast(!0,"Your contribution changes the world in better")},n.componentDidMount=function(){n.getProjectInfo()},n.state={project:null,modalShow:!1,toast:{show:!1,text:""}},n.projectService=new v,n}return Object(c.a)(a,[{key:"getProjectInfo",value:function(){var e=this,t=this.props.match.params.projectId;this.projectService.getProject(t).then((function(t){return e.setState({project:t.data})})).catch((function(e){return console.log(e)}))}},{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,this.state.project?r.a.createElement(y.a,{as:"section",className:"project-details"},r.a.createElement(k.a,null,r.a.createElement(I.a,{md:{span:4,offset:1}},r.a.createElement(I.a,{md:6},r.a.createElement("img",{src:this.state.project.photos,alt:"Project photos"})),r.a.createElement("br",null),r.a.createElement("ul",null,r.a.createElement("li",null,"Description: ",this.state.project.description)," ",r.a.createElement("br",null)," ",r.a.createElement("hr",null),r.a.createElement("li",null,"Goal: ",this.state.project.currentAmount,"\u20ac / ",this.state.project.goal,"\u20ac - ",r.a.createElement(U.a,{onClick:function(){return e.handleModal(!0)}},r.a.createElement("small",null,"Contribute"))),r.a.createElement("li",null,"Cleaners: ",this.state.project.helpers.length," / ",this.state.project.helpersNeeded," - ",r.a.createElement(U.a,null,r.a.createElement("small",null,"Help"))))),r.a.createElement(M.a,{show:this.state.modalShow,className:"contribution-modal",onHide:function(){return e.handleModal(!1)}},r.a.createElement(M.a.Body,null,r.a.createElement(L,{project:this.state.project,creator:this.props.user,finishProjectPost:this.finishProjectPost,closeModal:function(){return e.handleModal(!1)}}))),r.a.createElement(x.a,{className:"contribution-toast",onClose:function(){return e.handletoast(!1)},show:this.state.toast.show,delay:3e3,autohide:!0},r.a.createElement(x.a.Header,null,r.a.createElement("img",{src:"holder.js/20x20?text=%20",className:"rounded mr-2",alt:""}),r.a.createElement("strong",{className:"mr-auto"},"Cool!")),r.a.createElement(x.a.Body,null,this.state.toast.text))),r.a.createElement(f.b,{to:"/projects",className:"back"},"Back")):r.a.createElement("h1",null,"Loading..."))}}]),a}(n.Component)),D=function(e){Object(i.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).handleInputChange=function(e){var t=Object(b.a)({},n.state.loginInfo),a=e.target,r=a.name,o=a.value;t=Object(b.a)(Object(b.a)({},t),{},Object(S.a)({},r,o)),n.setState({loginInfo:t})},n.handleSubmit=function(e){e.preventDefault(),n.authService.signup(n.state.loginInfo).then((function(e){n.props.setTheUser(e.data),n.props.history.push("/")})).catch((function(e){400===e.response.status&&n.setState({errorMessage:e.response.data.message})}))},n.state={loginInfo:{username:"",password:""},errorMessage:""},n.authService=new E,n}return Object(c.a)(a,[{key:"render",value:function(){return r.a.createElement(y.a,null,r.a.createElement(k.a,null,r.a.createElement(I.a,{md:{span:4,offset:4}},r.a.createElement("h3",null,"Sign up"),r.a.createElement("hr",null),r.a.createElement(C.a,{onSubmit:this.handleSubmit},r.a.createElement(C.a.Group,{controlId:"name"},r.a.createElement(C.a.Label,null,"Username"),r.a.createElement(C.a.Control,{name:"username",type:"text",value:this.state.username,onChange:this.handleInputChange})),r.a.createElement(C.a.Group,{controlId:"pwd"},r.a.createElement(C.a.Label,null,"Password"),r.a.createElement(C.a.Control,{name:"password",type:"password",value:this.state.password,onChange:this.handleInputChange})),r.a.createElement("p",{className:"error-message",style:{display:this.state.errorMessage?"block":"none"}},this.state.errorMessage),r.a.createElement(U.a,{variant:"dark",type:"submit"},"Sign up")),r.a.createElement("p",null,r.a.createElement("small",null,"Do you have already an account? ",r.a.createElement(f.b,{to:"/login"},"Login"))))))}}]),a}(n.Component),A=function(e){Object(i.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).handleInputChange=function(e){var t=Object(b.a)({},n.state.loginInfo),a=e.target,r=a.name,o=a.value;t=Object(b.a)(Object(b.a)({},t),{},Object(S.a)({},r,o)),n.setState({loginInfo:t})},n.handleSubmit=function(e){e.preventDefault(),n.authService.login(n.state.loginInfo).then((function(e){console.log("response: ",e),n.props.setTheUser(e.data),n.props.history.push("/")})).catch((function(e){400===e.response.status&&n.setState({errorMessage:e.response.data.message})}))},n.state={loginInfo:{username:"",password:""},errorMessage:""},n.authService=new E,n}return Object(c.a)(a,[{key:"render",value:function(){return r.a.createElement(y.a,null,r.a.createElement(k.a,null,r.a.createElement(I.a,{md:{span:4,offset:4}},r.a.createElement("h3",null,"Login"),r.a.createElement("hr",null),r.a.createElement(C.a,{onSubmit:this.handleSubmit},r.a.createElement(C.a.Group,{controlId:"name"},r.a.createElement(C.a.Label,null,"Username"),r.a.createElement(C.a.Control,{name:"username",type:"text",value:this.state.username,onChange:this.handleInputChange})),r.a.createElement(C.a.Group,{controlId:"pwd"},r.a.createElement(C.a.Label,null,"Password"),r.a.createElement(C.a.Control,{name:"password",type:"password",value:this.state.password,onChange:this.handleInputChange})),r.a.createElement("p",{className:"error-message",style:{display:this.state.errorMessage?"block":"none"}},this.state.errorMessage),r.a.createElement(U.a,{variant:"dark",type:"submit"},"Log in")),r.a.createElement("p",null,r.a.createElement("small",null,"Don\xb4t you have an account yet? ",r.a.createElement(f.b,{to:"/signup"},"Sign Up"))))))}}]),a}(n.Component),B=function(e){return r.a.createElement(I.a,{xs:6},r.a.createElement(f.b,{to:"/projects/".concat(e._id)},r.a.createElement(w.a,{as:"article",className:"profile-card"},r.a.createElement(w.a.Img,{variant:"top",src:e.photos[0]}),r.a.createElement(w.a.Body,null,r.a.createElement("p",null,e.city)))))},_=(a(104),function(e){Object(i.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).getNewSets=function(){var e=n.props.loggedInUser.contributing,t=Array.from(new Set(e.map((function(e){return e._id})))).map((function(t){return e.find((function(e){return e._id===t}))}));return n.setState({contributingProj:t})},n.componentDidMount=function(){n.getNewSets()},n.state={contributingProj:[]},n.projectService=new v,n}return Object(c.a)(a,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(y.a,{as:"section",className:"profile-header"},r.a.createElement(k.a,{as:"header"},r.a.createElement(I.a,{xs:{span:6,offset:4}}," ",r.a.createElement("img",{alt:this.props.loggedInUser.username,src:this.props.loggedInUser.profileImg})," ")),r.a.createElement(k.a,{as:"article"},r.a.createElement(I.a,{xs:{span:6,offset:3}}," ",r.a.createElement("h6",null,this.props.loggedInUser.username)," ")),r.a.createElement(k.a,{as:"article"},r.a.createElement(I.a,{xs:{span:6,offset:3}}," Wallet: ",this.props.loggedInUser.wallet," \u20ac"))),r.a.createElement(y.a,{as:"section",className:"profile-projects"},r.a.createElement("h5",null,"Own projects"),r.a.createElement(k.a,{as:"article",className:"projects-profile"},this.props.loggedInUser.ownProjects.map((function(e){return r.a.createElement(B,Object.assign({key:e._id},e))}))),r.a.createElement("h5",null,"Contributing"),r.a.createElement(k.a,{as:"article",className:"projects-profile flex-row flex-nowrap"},this.state.contributingProj.map((function(e){return r.a.createElement(B,Object.assign({key:e._id},e))}))),r.a.createElement("h5",null,"Helping"),r.a.createElement(k.a,{as:"article",className:"projects-profile"},this.props.loggedInUser.helping.map((function(e){return r.a.createElement(B,Object.assign({key:e._id},e))}))),r.a.createElement(k.a,{className:"profile-button"},r.a.createElement(I.a,{xs:{span:6,offset:3}},r.a.createElement(f.b,{to:"/projects",className:"btn-primary"}," Discover new projects ")))))}}]),a}(n.Component)),G=function(e){Object(i.a)(a,e);var t=Object(u.a)(a);function a(){var e;return Object(s.a)(this,a),(e=t.call(this)).setTheUser=function(t){return e.setState({loggedInUser:t},(function(){return console.log("El estado de App ha cambiado:",e.state)}))},e.fetchUser=function(){null===e.state.loggedInUser&&e.authService.isLoggedIn().then((function(t){return e.setTheUser(t.data)})).catch((function(){return e.setTheUser(!1)}))},e.state={loggedInUser:null},e.authService=new E,e}return Object(c.a)(a,[{key:"render",value:function(){var e=this;return this.fetchUser(),r.a.createElement(r.a.Fragment,null,r.a.createElement(j,{setTheUser:this.setTheUser,loggedInUser:this.state.loggedInUser}),r.a.createElement("main",null,r.a.createElement(m.d,null,r.a.createElement(m.b,{path:"/projects",exact:!0,render:function(){return r.a.createElement(N,{loggedInUser:e.state.loggedInUser})}}),r.a.createElement(m.b,{path:"/projects/:projectId",render:function(t){return r.a.createElement(T,Object.assign({},t,{user:e.state.loggedInUser}))}}),r.a.createElement(m.b,{path:"/signup",render:function(t){return r.a.createElement(D,Object.assign({},t,{setTheUser:e.setTheUser}))}}),r.a.createElement(m.b,{path:"/login",render:function(t){return r.a.createElement(A,Object.assign({},t,{setTheUser:e.setTheUser}))}}),r.a.createElement(m.b,{path:"/profile",render:function(){return e.state.loggedInUser?r.a.createElement(_,{loggedInUser:e.state.loggedInUser}):r.a.createElement(m.a,{to:"/"})}}))))}}]),a}(n.Component);l.a.render(r.a.createElement(f.a,null,r.a.createElement(G,null)),document.getElementById("root"))},72:function(e,t,a){e.exports=a(105)},78:function(e,t,a){}},[[72,1,2]]]);
//# sourceMappingURL=main.d633f5b9.chunk.js.map